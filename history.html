<link rel="stylesheet" type="text/css" href="style.css">
<script src="main.js"></script>
<script src="design.js"></script>
<div align="center">
<table align="center" width="90%" style="border-spacing: 15px">
	  <tr>
		<th></th>
	    <th id="housing" class="weather_housing" colspan="2" style="border-radius: 40px">
        </th>
		<th></th>
      </tr>
	  <tr>
      </tr>
      <tr align="center">
        <th width="25%">
			<table id="historytable1" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage1" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp1" class="history_text_temp"></p>
				  <p id="historyweather1" class="history_text_weather"></p>
				  <label id="historyday1" class="history_text_date"></label><br>
				  <label id="historymonth1" class="history_text_date"></label><br>
				  <label id="historyyear1" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
        <th width="25%">
			<table id="historytable2" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage2" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp2" class="history_text_temp"></p>
				  <p id="historyweather2" class="history_text_weather"></p>
				  <label id="historyday2" class="history_text_date"></label><br>
				  <label id="historymonth2" class="history_text_date"></label><br>
				  <label id="historyyear2" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>

        <th width="25%">
			<table id="historytable3" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage3" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp3" class="history_text_temp"></p>
				  <p id="historyweather3" class="history_text_weather"></p>
				  <label id="historyday3" class="history_text_date"></label><br>
				  <label id="historymonth3" class="history_text_date"></label><br>
				  <label id="historyyear3" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
        <th width="25%">
			<table id="historytable4" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage4" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp4" class="history_text_temp"></p>
				  <p id="historyweather4" class="history_text_weather"></p>
				  <label id="historyday4" class="history_text_date"></label><br>
				  <label id="historymonth4" class="history_text_date"></label><br>
				  <label id="historyyear4" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
      </tr>
	  <tr align="center">
        <th width="25%">
			<table id="historytable5" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage5" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp5" class="history_text_temp"></p>
				  <p id="historyweather5" class="history_text_weather"></p>
				  <label id="historyday5" class="history_text_date"></label><br>
				  <label id="historymonth5" class="history_text_date"></label><br>
				  <label id="historyyear5" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
        <th width="25%">
			<table id="historytable6" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage6" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp6" class="history_text_temp"></p>
				  <p id="historyweather6" class="history_text_weather"></p>
				  <label id="historyday6" class="history_text_date"></label><br>
				  <label id="historymonth6" class="history_text_date"></label><br>
				  <label id="historyyear6" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>

        <th width="25%">
			<table id="historytable7" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage7" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp7" class="history_text_temp"></p>
				  <p id="historyweather7" class="history_text_weather"></p>
				  <label id="historyday7" class="history_text_date"></label><br>
				  <label id="historymonth7" class="history_text_date"></label><br>
				  <label id="historyyear7" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
		
        <th width="25%">
			<table id="historytable8" class="history_in_table" >
			  <tr>
				<th width="65%">
				  <img id="historyimage8" src="load.gif" width="100%" border="1px" style="border-color: #f4f4f4">
				</th>
				<th width="35%">
				  <p id="historytemp8" class="history_text_temp"></p>
				  <p id="historyweather8" class="history_text_weather"></p>
				  <label id="historyday8" class="history_text_date"></label><br>
				  <label id="historymonth8" class="history_text_date"></label><br>
				  <label id="historyyear8" class="history_text_date"></label>
				</th>
			  </tr>
			</table>
			<br>
        </th>
      </tr>
</table>
</div>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
  import { getDatabase, ref, onValue} from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";
  const firebaseConfig = {
    apiKey: "AIzaSyD5cL3GT9-v1q5vieAD9GXxhfsSxb4gI6U",
    authDomain: "meteo-80951.firebaseapp.com",
    databaseURL: "https://meteo-80951-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "meteo-80951",
    storageBucket: "meteo-80951.appspot.com",
    messagingSenderId: "432785078592",
    appId: "1:432785078592:web:f3be0a263f8f0c470222a5",
    measurementId: "G-R2YTDWS40Z"
  };
  
  var housing = "";
  
  var b = localStorage.getItem('build');
  if (b==null) {
		localStorage.setItem('build', "build1");
		b = "build1";
	}
  switch(b) {
			case "build1":
				document.getElementById("housing").textContent = "Уфа, Корпуса №1-4, 7-11";
				break;
				
			case "build5":
				document.getElementById("housing").textContent = "Уфа, Корпуса №5-6";
				break;
				
			case "build12":
				document.getElementById("housing").textContent = "Уфа, Корпус №12";
				break;
					
			case "build13":
				document.getElementById("housing").textContent = "Уфа, Корпус №13";
				break;
					
			case "build9":
				document.getElementById("housing").textContent = "Уфа, Общежитие №9";
				break;
					
			case "buildokt":
				document.getElementById("housing").textContent = "Октябрьский, Корпуса №1-2";
				break;
					
			case "buildstr":
				document.getElementById("housing").textContent = "Стерлитамак, Корпус №1";
				break;
					
			case "buildsal":
				document.getElementById("housing").textContent = "Салават, корпус №1";
			break;
		  }
  
  function getValueWeather(app, db, valueWeather, i) {
	onValue(ref(db, 'Data/history/' + b + "/" + valueWeather + i), (snapshot) => {
	  const data = snapshot.val();
	  console.log(valueWeather + i);
	  switch (valueWeather) {
		case "temp":
		  document.getElementById("history" + valueWeather + i).textContent = data+"°C";
		  break;
		case "weather":
		  document.getElementById("history" + valueWeather + i).textContent = data;
		  break;
	  }
	});
  }
  
  
  const app = initializeApp(firebaseConfig);
  const db = getDatabase();
  
  const valuesWeather = ["temp", "weather"];
  
  let date = new Date();
  for(let i = 1; i <= 8; i++){
	valuesWeather.forEach(function(valueWeather) {
		getValueWeather(app, db, valueWeather, i.toString());
	})
	
	date.setDate(date.getDate() - 1);
	document.getElementById("historyday" + i.toString()).textContent = date.getDate();
	
	var month=new Array("января","февраля","марта","апреля","мая","июня",
"июля","августа","сентября","октября","ноября","декабря");

	document.getElementById("historymonth" + i.toString()).textContent = month[date.getMonth()];
	document.getElementById("historyyear" + i.toString()).textContent = date.getFullYear();
	
	setTimeout(function() {
	  setImageHistory(i.toString());
	}, 1000);
	
	
	designHistory();
  }
</script>